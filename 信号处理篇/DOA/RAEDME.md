# DOA

## 相位差

在进行角度结算前，在回顾下雷达系统中的相位差知识。

### 相位差计算公式

相位差$\Delta \phi$ 的计算公式依赖于以下几个参数：

- $d$：天线间的距离（天线阵列中相邻天线之间的距离）。
- $\theta$：目标的方位角度。
- $\lambda$：信号的波长。

相位差的基本公式是：

$$
\Delta \phi = \frac{2\pi}{\lambda} \Delta x
$$

其中，$\Delta x$ 是由于天线间距和目标方位角产生的路径长度差，计算方法为：

$$
\Delta x = d \sin(\theta)
$$

将 $\Delta x$ 代入相位差的公式中，我们得到：

$$
\Delta \phi = \frac{2\pi}{\lambda} (d \sin(\theta))
$$

### 详细解释

- **波长 ($\lambda$)**：这是雷达使用的信号的波长，它与雷达操作的频率有关。例如，77 GHz 的毫米波雷达的波长约为 3.9 毫米。
- **天线间距 ($d$)**：这是阵列中相邻天线之间的距离。通常，这个距离可以是波长的一半或其他分数，这取决于天线阵列的设计和所需的波束形成特性。
- **方位角 ($\theta$)**：这是目标相对于雷达阵列正前方的角度。角度 $\theta$ 的正弦值 $\sin(\theta)$ 决定了由于天线间距引起的路径长度差。

这个相位差是关键参数，因为它直接影响到从雷达信号中提取目标位置信息的能力。通过测量不同天线接收到的信号的相位差，可以使用信号处理技术（如FFT）来估计目标的方位角。


## FFT

NONE

<br>

## MUSIC

MUSIC（Multiple Signal Classification）算法是一种广泛用于信号处理领域的谱估计方法，特别是在阵列信号处理（如方向估计或源定位）中非常有效。MUSIC算法基于信号子空间和噪声子空间的概念，利用接收到的信号中的空间特性来估计波达方向（Direction of Arrival, DOA）或源位置。

### MUSIC算法的基本原理包括以下几个关键步骤：

#### 1. 数据模型
假设一个由$P$个窄带远场信号源构成的信号被一个包含$M$个传感器的阵列接收。信号模型可以表示为：
$\mathbf{X}(t) = \mathbf{A}(\mathbf{s}) \mathbf{s}(t) + \mathbf{n}(t)$
其中，$\mathbf{X}(t)$是接收信号矢量，$\mathbf{A}(\mathbf{s})$是由信号源的方向向量构成的阵列流形矩阵，$\mathbf{s}(t)$是源信号矢量，$\mathbf{n}(t)$是噪声矢量。

#### 2. 协方差矩阵的估计
计算接收信号的协方差矩阵：
$\mathbf{R} = \frac{1}{N} \sum_{t=1}^N \mathbf{X}(t) \mathbf{X}^H(t)$
其中，$N$是样本数，$H$表示共轭转置。

#### 3. 特征分解
对协方差矩阵$\mathbf{R}$进行特征分解，得到其特征值和特征向量。将特征向量按对应特征值的大小排序，最大的$P$个特征值对应的特征向量构成信号子空间，其余的特征向量构成噪声子空间。

#### 4. 空间谱函数的构建
MUSIC算法的核心在于构建一个空间谱函数，该函数在源存在的方向上具有峰值。空间谱函数定义为：
$P(\theta) = \frac{1}{\mathbf{a}^H(\theta) \mathbf{E}_n \mathbf{E}_n^H \mathbf{a}(\theta)}$
其中，$\mathbf{a}(\theta)$是给定方向$\theta$下的阵列流形向量，$\mathbf{E}_n$是噪声子空间的基底。

#### 5. 方向估计
通过搜索空间谱函数$P(\theta)$的峰值来估计信号源的方向。峰值的位置对应于信号源的方向。

### 特点
- MUSIC算法提供了非常高的分辨率，能够区分相距非常近的信号源。
- 它是一种基于数据的方法，不需要关于信号或噪声的先验知识。
- 适用于信号源数少于传感器数的情况。

### 限制
- 当信号源数目接近或超过传感器数目时，性能会下降。
- 对模型中的假设（如信号和噪声的统计独立性）敏感。

MUSIC算法是阵列信号处理中一个非常强大的工具，广泛应用于雷达、声纳、无线通信等领域。


<br>

## ROOT_MUSIC


<br>

## CAPON(MVDR)

CAPON算法，也称为最小方差无失真响应 (MVDR) 波束形成器，是一种在阵列信号处理中广泛使用的技术，特别是在雷达、声纳和无线通信等领域。它是一种自适应波束形成方法，旨在通过最小化输出信号的方差同时保持期望信号方向上的增益为1，从而增强特定方向上的信号并抑制来自其他方向的干扰和噪声。

### CAPON算法的基本原理

CAPON算法的核心思想是构造一个自适应权重向量，使得阵列输出的功率最小，同时对期望信号方向的响应不受影响（无失真）。这可以通过求解以下优化问题实现：

$$ \min_{\mathbf{w}} \mathbf{w}^H \mathbf{R} \mathbf{w} $$
$$ \text{subject to } \mathbf{w}^H \mathbf{a}(\theta_0) = 1 $$

其中：
- $\mathbf{w}$ 是复权重向量。
- $\mathbf{R}$ 是接收信号的协方差矩阵。
- $\mathbf{a}(\theta_0)$ 是期望信号方向$\theta_0$上的阵列流形向量。
- $H$ 表示共轭转置。

### CAPON算法的步骤

1. **协方差矩阵估计**：计算接收信号的协方差矩阵 $$\mathbf{R}$$。这通常是通过对接收到的信号样本进行平均来实现的。
2. **求解优化问题**：利用拉格朗日乘数法，可以得到最优权重向量的解为：
    $$
    \mathbf{w} = \frac{\mathbf{R}^{-1} \mathbf{a}(\theta_0)}{\mathbf{a}^H(\theta_0) \mathbf{R}^{-1} \mathbf{a}(\theta_0)} 
    $$
3. **波束形成输出**：使用得到的权重向量 $$\mathbf{w}$$ 对接收信号进行加权和，得到增强的输出信号。

### 特点和应用

- **抑制干扰**：CAPON算法通过最小化输出功率有效地抑制了非期望方向上的干扰和噪声。
- **自适应性**：算法能够根据输入信号的统计特性自动调整权重，适应环境变化。
- **应用广泛**：广泛应用于雷达信号处理、声纳系统、无线通信等领域，特别是在环境复杂或干扰严重的情况下。

CAPON算法提供了一种有效的方式来提高系统对期望信号的接收性能，同时抑制干扰，这使得它在实际应用中具有重要的价值。


### 与MUSIC比较

CAPON (最小方差无失真响应, MVDR) 波束形成器和 MUSIC (多重信号分类) 算法虽然都用于信号处理中的方向估计（DOA估计），但它们的设计目标、应用场景和性能特点有所不同。选择哪种算法更好通常取决于具体的应用需求、信号环境和系统资源。以下是两种算法的比较，可以帮助理解它们的优缺点：

#### CAPON 算法

**优点**：
1. **抑制干扰**：CAPON算法通过最小化输出功率有效地抑制非目标方向上的干扰和噪声。
2. **自适应性**：能够根据接收信号的统计特性自动调整权重，适应环境变化。
3. **实时性**：通常计算复杂度较低，适合实时处理应用。

**缺点**：
1. **性能依赖于协方差矩阵的精确估计**：如果协方差矩阵估计不准确，性能会显著下降。
2. **对信号源数量的敏感性**：当信号源数量接近或超过阵列元素数量时，性能可能会下降。

#### MUSIC 算法

**优点**：
1. **高分辨率**：MUSIC算法能够提供比传统波束形成方法更高的角度分辨率。
2. **适用于多信号源**：能够有效处理多个信号源的情况，即使这些信号源相距很近。
3. **鲁棒性**：对于噪声和干扰具有较好的鲁棒性，尤其是在高信噪比环境下。

**缺点**：
1. **计算复杂度高**：需要进行特征分解和搜索峰值，计算量较大。
2. **对信号模型敏感**：算法性能依赖于信号模型的准确性，如信号源的数量和信号波形。

#### 总结

- 如果目标是在多信号源环境中获得高分辨率的角度估计，MUSIC算法通常是更好的选择。
- 如果需要实时处理并且环境中存在大量干扰，CAPON算法可能更适合，因为它能够自适应地抑制干扰并且具有较低的计算复杂度。

在实际应用中，选择最合适的算法还需要考虑到系统的具体需求，如处理速度、精度要求、硬件资源等因素。在一些应用中，可能会结合使用这两种算法，以利用各自的优势，达到最佳的整体性能。
